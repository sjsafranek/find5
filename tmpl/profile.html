{{define "profile"}}

<!DOCTYPE html>
<html>
	<head>
		<title>FIND 5</title>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<script src="/static/jquery/3.4.1/jquery.min.js"></script>
		<script src="/static/vue/vue.min.js"></script>
		<script src="/static/sweetalert2/sweetalert2.all.min.js"></script>

		<!-- Font Awesome CSS -->
		<link rel="stylesheet" href="/static/fontawesome/5.9.0/css/all.css">

		<!-- Bootstrap -->
        <link rel="stylesheet" href="/static/bootstrap/4.1.3/css/bootstrap.min.css">
		<script src="/static/bootstrap/4.1.3/js/bootstrap.min.js"></script>


		<script src="/static/app.js"></script>
		<style>
			.selected {
				background-color: darkred;
				color: white;
			}
		</style>

	</head>
	<body>

		<div class="container-fluid">

			<div class="row" id="user">
				<label>[| username |]</label>
			</div>

			<div class="row">

				<div class="col col-2" id="devices">
					<label>Devices</label>
					<button class="btn btn-sm btn-default" v-on:click="createDevice()">
						<i class="fa fa-plus"></i>
					</button>
					<div class="objects"></div>
				</div>

				<div class="col col-4" id="device" style="display: none;">
					<label>Device</label>
					<div class="attributes selected">
						<div><label>name:</label>  [| name |]</div>
						<div><label>id:</label>  [| id |]</div>
						<div><label>type:</label>  [| type |]</div>
						<div><label>is_active:</label>  [| is_active |]</div>
						<div><label>is_deleted:</label>  [| is_deleted |]</div>
						<div><label>created_at:</label>  [| created_at |]</div>
						<div><label>updated_at:</label>  [| updated_at |]</div>
					</div>
				</div>

				<div class="col col-2" id="sensors" style="display: none;">
					<label>sensors</label>
					<button class="btn btn-sm btn-default" v-on:click="createSensor()">
						<i class="fa fa-plus"></i>
					</button>
					<div class="objects"></div>
				</div>

				<div class="col col-4" id="sensor" style="display: none;">
					<label>Sensor</label>
					<div class="attributes selected">
						<div><label>name:</label>  [| name |]</div>
						<div><label>id:</label>  [| id |]</div>
						<div><label>type:</label>  [| type |]</div>
						<div><label>is_active:</label>  [| is_active |]</div>
						<div><label>is_deleted:</label>  [| is_deleted |]</div>
						<div><label>created_at:</label>  [| created_at |]</div>
						<div><label>updated_at:</label>  [| updated_at |]</div>
					</div>
				</div>

			</div>

		</div>

		<script>

			var api,
				app;


			function FindApi(user) {
				this.user = user;
			}

			FindApi.prototype.do = function(payload, callback) {
				payload.apikey = this.user.apikey;		// <-- always add apikey to api call
				callback = callback || console.log; 	// <-- default callback
				$.post("/api/v1/find", JSON.stringify(payload))
					.done(function(data) {
						callback && callback(null, data);
					})
					.fail(function(xhr){
						callback(xhr.responseJSON);
					});
			}

			FindApi.prototype.getDevices = function(callback) {
				this.do({"method":"get_devices"}, callback);
			}

			FindApi.prototype.createDevice = function(name, type, callback) {
				this.do({"method":"create_device", "name":name, "type":type}, callback);
			}

			FindApi.prototype.createSensor = function(device_id, name, type, callback) {
				this.do({"method":"create_sensor", "device_id": device_id, "name":name, "type":type}, callback);
			}

			FindApi.prototype.getSensors = function(device_id, callback) {
				this.do({"method":"get_sensors", "device_id": device_id}, callback);
			}



			$(document).ready(function(){
				api = new FindApi({{ index . }});
				app = new App({{ index . }}, api);
			});

		</script>
	</body>
</html>

{{end}}
