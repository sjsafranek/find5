{{define "profile"}}

<!DOCTYPE html>
<html>
	<head>
		<title>FIND 5</title>
		<!-- <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1"> -->

        {{template "global_header" .}}

		<!-- <script src="/static/jquery/3.4.1/jquery.min.js"></script> -->
		<script src="/static/vue/vue.min.js"></script>

		<!-- Font Awesome CSS -->
		<!-- <link rel="stylesheet" href="/static/fontawesome/5.9.0/css/all.css"> -->

		<!-- Bootstrap -->
        <!-- <link rel="stylesheet" href="/static/bootstrap/4.1.3/css/bootstrap.min.css">
		<script src="/static/bootstrap/4.1.3/js/bootstrap.min.js"></script> -->


		<script src="/static/app.js"></script>
		<style>

			body {
				font-size: 0.75rem;
			}

			.selected {
				background-color: darkred;
				color: white;
			}

			.objects label {
				margin: 0.5rem;
				pointer-events: none;
			}

			.objects div {
				cursor: pointer;
			}


            .pulsate {
                -webkit-animation: pulsate 1.5s ease-out;
                -webkit-animation-iteration-count: infinite;
                background-color: rgb(198,200,202,0.1);
            }

            @-webkit-keyframes pulsate {
                0% {
                    background-color: rgb(198,200,202,0.1);
                }
                50% {
                    background-color: rgb(198,200,202,1.0);
                }
                100% {
                    background-color: rgb(198,200,202,0.1);
                }
            }



            /*.throbPath {
                -webkit-animation: throbPath 1.5s ease-out;
                -webkit-animation-iteration-count: infinite;
                stroke-width: 1;
            }

            @-webkit-keyframes throbPath {
                0% {
                    stroke-width: 1;
                }
                50% {
                    stroke-width: 4;
                }
                100% {
                    stroke-width: 1;
                }
            }*/


		</style>

	</head>
	<body>

		{{template "navbar" .}}

		<div class="container">

			<div class="row" id="user">
				<label>[| username |]</label>
			</div>

			<div class="row">

				<div class="col col-2" id="devices">
					<label>Devices</label>
					<button class="btn btn-sm btn-default" v-on:click="createDevice()">
						<i class="fa fa-plus"></i>
					</button>
					<div class="objects"></div>
				</div>

				<div class="col col-4" id="device" style="display: none;">
					<label>Device</label>
					<div class="attributes">
						<div><label>name:</label>  [| name |]</div>
						<div><label>id:</label>  [| id |]</div>
						<div><label>type:</label>  [| type |]</div>
						<div><label>is_active:</label>  [| is_active |]</div>
						<div><label>is_deleted:</label>  [| is_deleted |]</div>
						<div><label>created_at:</label>  [| created_at |]</div>
						<div><label>updated_at:</label>  [| updated_at |]</div>
					</div>
				</div>

				<div class="col col-2" id="sensors" style="display: none;">
					<label>sensors</label>
					<button class="btn btn-sm btn-default" v-on:click="createSensor()">
						<i class="fa fa-plus"></i>
					</button>
					<div class="objects"></div>
				</div>

				<div class="col col-4" id="sensor" style="display: none;">
					<label>Sensor</label>
					<div class="attributes">
						<div><label>name:</label>  [| name |]</div>
						<div><label>id:</label>  [| id |]</div>
						<div><label>type:</label>  [| type |]</div>
						<div><label>is_active:</label>  [| is_active |]</div>
						<div><label>is_deleted:</label>  [| is_deleted |]</div>
						<div><label>created_at:</label>  [| created_at |]</div>
						<div><label>updated_at:</label>  [| updated_at |]</div>
					</div>
				</div>

			</div>

		</div>

		<script>

			var api,
				app;


			function FindApi(user) {
				this.user = user;
			}

			FindApi.prototype.do = function(payload, callback) {
				payload.params = payload.params || {};
				payload.params.apikey = this.user.apikey;		// <-- always add apikey to api call
				payload.params.username = this.user.username;		// <-- always add apikey to api call
				callback = callback || console.log; 	// <-- default callback
				return $.ajax({
					method: "POST",
					url: '/api',
					contentType: "application/json",
					data: JSON.stringify(payload),
					success: function(data) {
						callback && callback(null, data.data);
					},
					error: function(jqXHR, textStatus, errorThrown) {
						console.log(jqXHR, textStatus, errorThrown);
						callback && callback(jqXHR.responseJSON || jqXHR.responseText);
					}
				});
			}

			FindApi.prototype.getDevices = function(callback) {
				return this.do({"method":"get_devices"}, callback);
			}

			FindApi.prototype.createDevice = function(name, type, callback) {
				return this.do({"method":"create_device", "params": {"name":name, "type":type}}, callback);
			}

			FindApi.prototype.createSensor = function(device_id, name, type, callback) {
				return this.do({"method":"create_sensor", "params": {"device_id": device_id, "name":name, "type":type}}, callback);
			}

			FindApi.prototype.getSensors = function(device_id, callback) {
				return this.do({"method":"get_sensors", "params": {"device_id": device_id}}, callback);
			}


			$(document).ready(function(){
				api = new FindApi({{ index . }});
				app = new App({{ index . }}, api);
			});

		</script>
	</body>
</html>

{{end}}
